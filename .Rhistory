# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("blue", "green", "red", "purple")) +  # Same color for both Acute and Chronic of each region
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = 1.5, vjust = 1.5, size = 3)  # Label mutations with >50%
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("blue", "green", "red", "purple")) +  # Same color for both Acute and Chronic of each region
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50% to the left of points
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("blue", "green", "red", "purple")) +  # Same color for both Acute and Chronic of each region
geom_text(aes(label = ifelse(Percentage > 25, Mutation_Label, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50% to the left of points
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#D55E00", "#0072B2", "#CC79A7", "#F0E442")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50% to the left of points
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50% to the left of points
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Identify the mutation near the y-axis with Percentage very low
near_axis_mutation <- combined_data %>%
filter(Percentage < 10) %>%  # Adjust the threshold to find the mutation near the axis
.$Mutation_Label
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = ifelse(Mutation_Label %in% near_axis_mutation, -0.2, 1.2),  # Adjust hjust based on position
vjust = 0.5, size = 3)  # Label mutations with >50%, near axis labels go to the right
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Identify the mutation near the y-axis with Percentage very low
near_axis_mutation <- combined_data %>%
filter(Percentage < 10) %>%  # Adjust the threshold to find the mutation near the axis
.$Mutation_Label
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = ifelse(Mutation_Label %in% near_axis_mutation, -0.2, 1.2),  # Adjust hjust based on position
vjust = 0.5, size = 3)  # Label mutations with >50%, near axis labels go to the right
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Remove duplicate mutation labels, keeping only the one with the highest percentage
combined_data <- combined_data %>%
group_by(Mutation_Label) %>%
filter(Percentage == max(Percentage)) %>%
ungroup()
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 50, Mutation_Label, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50% to the left of points
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Remove duplicate mutation labels, but retain all dots
combined_data <- combined_data %>%
group_by(Mutation_Label) %>%
mutate(Label_Display = ifelse(Percentage == max(Percentage), Mutation_Label, NA)) %>%
ungroup()
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 50, Label_Display, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50%, only highest percentage
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the dataset
data <- read.csv("Acute_Chronic_Mutations.csv", skip = 2)  # Skip the first two header rows
# Rename columns for clarity
colnames(data) <- c('RT_Mutation', 'RT_Acute', 'SHB_Mutation', 'SHB_Acute',
'Pre_Core_Mutation', 'Pre_Core_Acute', 'Core_Mutation',
'Core_Acute', 'RT_Mutation_Chronic', 'RT_Chronic',
'RT_p_value', 'SHB_Mutation_Chronic', 'SHB_Chronic',
'SHB_p_value', 'Pre_Core_Mutation_Chronic',
'Pre_Core_Chronic', 'Pre_Core_p_value', 'Core_Mutation_Chronic',
'Core_Chronic', 'Core_p_value')
# Select relevant columns for Acute and Chronic cases
acute_data <- data %>%
select(RT_Mutation, RT_Acute, SHB_Mutation, SHB_Acute, Pre_Core_Mutation, Pre_Core_Acute, Core_Mutation, Core_Acute) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation, -SHB_Mutation, -Pre_Core_Mutation, -Core_Mutation)
chronic_data <- data %>%
select(RT_Mutation_Chronic, RT_Chronic, SHB_Mutation_Chronic, SHB_Chronic, Pre_Core_Mutation_Chronic, Pre_Core_Chronic, Core_Mutation_Chronic, Core_Chronic) %>%
gather(key = "Region", value = "Percentage", -RT_Mutation_Chronic, -SHB_Mutation_Chronic, -Pre_Core_Mutation_Chronic, -Core_Mutation_Chronic)
# Add a new column for case type
acute_data$Case_Type <- 'Acute'
chronic_data$Case_Type <- 'Chronic'
# Combine Acute and Chronic data
combined_data <- bind_rows(
acute_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Acute", RT_Mutation,
ifelse(Region == "SHB_Acute", SHB_Mutation,
ifelse(Region == "Pre_Core_Acute", Pre_Core_Mutation,
Core_Mutation))))),
chronic_data %>% mutate(Mutation_Label = with(., ifelse(Region == "RT_Chronic", RT_Mutation_Chronic,
ifelse(Region == "SHB_Chronic", SHB_Mutation_Chronic,
ifelse(Region == "Pre_Core_Chronic", Pre_Core_Mutation_Chronic,
Core_Mutation_Chronic)))))
)
# Assign region names (RT, SHB, Pre_Core, Core) to both Acute and Chronic cases
combined_data$Region_Type <- ifelse(grepl("RT", combined_data$Region), "RT",
ifelse(grepl("SHB", combined_data$Region), "SHB",
ifelse(grepl("Pre_Core", combined_data$Region), "Pre_Core", "Core")))
# Remove duplicate mutation labels, but retain all dots
combined_data <- combined_data %>%
group_by(Mutation_Label) %>%
mutate(Label_Display = ifelse(Percentage == max(Percentage), Mutation_Label, NA)) %>%
ungroup()
# Plot using shapes for Acute/Chronic and colors for Regions
ggplot(combined_data, aes(x = Mutation_Label,
y = Percentage, shape = Case_Type, color = Region_Type)) +
geom_point(size = 3) +
theme(axis.text.x = element_blank()) +  # Remove x-axis labels
labs(title = "Distribution of Mutations in Acute and Chronic Cases", x = "Mutations", y = "Percentage Occurrence") +
scale_shape_manual(values = c(16, 17)) +  # Two shapes for Acute and Chronic
scale_color_manual(values = c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")) +  # New vibrant colors
geom_text(aes(label = ifelse(Percentage > 25, Label_Display, '')),
hjust = 1.2, vjust = 0.5, size = 3)  # Label mutations with >50%, only highest percentage
citation()
